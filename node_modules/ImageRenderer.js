//ImageRenderer.js
//The ImageRenderer composition displays an image on screen based on a Transform component

var Composition = require('Composition');
var Canvas = require('Canvas');

module.exports = function(imagePath, zIndex){
	//Create an empty Composition
	var ImageRenderer = new Composition();

	//Create a new canvas and set the zIndex
	ImageRenderer.canvas = new Canvas();
	ImageRenderer.canvas.setZIndex(zIndex || 0);

	//Create an html image
	ImageRenderer.image = document.createElement('img');
	//Set image src attribute to path
	ImageRenderer.image.src = imagePath;

	ImageRenderer.draw = function(){
		//Draw image at coordinates given in the Transform component
		this.canvas.context.drawImage(this.image, this.base.transform.position.x, this.base.transform.position.y);
		// console.log("Test sun: " + JSON.stringify(this.base.transform.position.x));
	}
	ImageRenderer.clear = function(){
		//Clear previous draw
		this.canvas.context.clearRect(
			this.base.transform.position.x-1,
			this.base.transform.position.y-1,
			this.image.width+2,
			this.image.height+2
		);
	}
	//Return new Composition
	return ImageRenderer;
}
