//CharacterController.js
//Maps keyboard input to character movement.
//The character must have a rigidbody composition attached to it.
//Refer to player.js if you need to modify other properties of the player
//Remember this.base reffers to player.js
//To know what the keycode for a given key is, reffer to http://www.cambiaresearch.com/articles/15/javascript-char-codes-key-codes

var Composition = require('Composition');

module.exports = function(){
	var CharacterController = new Composition();


	CharacterController.update = function(){
		if(this.base.transform.position.x < 5){
			this.base.transform.localPosition.x = 5;
		}else if(this.base.transform.position.x > window.innerWidth-50){
			this.base.transform.localPosition.x = window.innerWidth-50;
		}
	}
	//When we get a keydown signal (Happens every frame the key is held down)
	CharacterController.keydown = function(key){
		if(this.base.collider.isGrounded){
			if(key == 39){ //If key is right arrow
				this.base.rigidbody.speed.x = 15; //Move right
			}else if(key == 37){ //If key is left arrow
				this.base.rigidbody.speed.x = -15; //Move left
			}
		}
	}

	//When we get a keyup signal (Once a key is released)
	CharacterController.keyup = function(key){
		if(key==39 || key==37){//If we release left or right arrow, stop moving
			this.base.rigidbody.speed.x = 0;
		}
	}

	return CharacterController;
}
